<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"><title>canvas实现九宫格解锁</title><style type="text/css" media="screen">body,html{margin:0;padding:0;overflow:hidden}#content{width:100%;height:100%;margin:0}</style></head><body><div id="content"></div><script type="text/javascript" src="http://code.jquery.com/jquery-1.11.3.min.js"></script><script type="text/javascript">function init(){ctx.clearRect(0,0,width,height),pointerArr=[];for(var t=0;t<arr.length;t++)arr[t].state=0,drawPointer(t)}function drawPointer(t){ctx.save();var e=0;e=hastouch?width/12:24,0==arr[t].state?(ctx.beginPath(),ctx.fillStyle="#dd514c",ctx.arc(arr[t].x,arr[t].y,6,0,2*Math.PI,!1),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.strokeStyle="#dd514c",ctx.lineWidth=.3,ctx.lineCap="round",ctx.lineJoin="round",ctx.arc(arr[t].x,arr[t].y,e,0,2*Math.PI,!1),ctx.stroke(),ctx.closePath()):(ctx.beginPath(),ctx.fillStyle="#dd514c",ctx.arc(arr[t].x,arr[t].y,6,0,2*Math.PI,!1),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.strokeStyle="#1bd6c5",ctx.lineWidth=.3,ctx.lineCap="round",ctx.lineJoin="round",ctx.arc(arr[t].x,arr[t].y,e,0,2*Math.PI,!1),ctx.stroke(),ctx.closePath()),ctx.restore()}function drawLinePointer(t,e,r){ctx.clearRect(0,0,width,height),ctx.save(),ctx.beginPath(),ctx.strokeStyle="#1bd6c5",ctx.lineWidth=5,ctx.lineCap="round",ctx.lineJoin="round";for(var c=0;c<pointerArr.length;c++)0==c?ctx.moveTo(pointerArr[c].x,pointerArr[c].y):ctx.lineTo(pointerArr[c].x,pointerArr[c].y);ctx.stroke(),ctx.closePath(),ctx.restore();for(var c=0;c<arr.length;c++)drawPointer(c),ctx.isPointInPath(t,e)&&currentPointer!=c&&(pointerArr.push({x:arr[c].x,y:arr[c].y}),currentPointer=c,puts.push(c+1),startX=arr[c].x,startY=arr[c].y,arr[c].state=1);r&&(ctx.save(),ctx.beginPath(),ctx.globalCompositeOperation="destination-over",ctx.strokeStyle="#e2e0e0",ctx.lineWidth=5,ctx.lineCap="round",ctx.lineJoin="round",ctx.moveTo(startX,startY),ctx.lineTo(t,e),ctx.stroke(),ctx.beginPath(),ctx.restore())}var width=$(document).width(),height=$(document).height()-40,canvas=document.createElement("canvas");canvas.width=width+.5,canvas.height=height+.5,canvas.id="lock",document.getElementById("content").appendChild(canvas);var clickFlag=!1,lockCnavs=$("#lock")[0],ctx=lockCnavs.getContext("2d"),lockCicle={x:0,y:0,color:"#999999",state:"1"},hastouch="ontouchstart"in window?!0:!1,tapstart=hastouch?"touchstart":"mousedown",tapmove=hastouch?"touchmove":"mousemove",tapend=hastouch?"touchend":"mouseup",pointerArr=[],startX,startY,puts=[],currentPointer,offset=(width-height)/2,arr=[];console.log(width+"         "+height);for(var i=1;3>=i;i++)for(var j=1;3>=j;j++){var lockCicle={};offset>0?(lockCicle.x=height/4*j+Math.abs(offset),lockCicle.y=height/4*i,lockCicle.state=0):(lockCicle.x=width/4*j,lockCicle.y=width/4*i+Math.abs(offset),lockCicle.state=0),arr.push(lockCicle)}init(),lockCnavs.addEventListener(tapstart,function(t){clickFlag=!0;var e=hastouch?t.targetTouches[0].pageX:t.clientX-canvas.offsetLeft,r=hastouch?t.targetTouches[0].pageY:t.clientY-canvas.offsetTop;drawLinePointer(e,r,!0)}),lockCnavs.addEventListener(tapmove,function(t){if(clickFlag){var e=hastouch?t.targetTouches[0].pageX:t.clientX-canvas.offsetLeft,r=hastouch?t.targetTouches[0].pageY:t.clientY-canvas.offsetTop;drawLinePointer(e,r,!0)}}),lockCnavs.addEventListener(tapend,function(t){drawLinePointer(0,0,!1),clickFlag=!1,pointerArr=[],puts.length>=5?alert("你的图形密码是: [   "+puts.join("    >   ")+"   ]"):puts.length>=1&&(alert("你的图形密码太简单了~~~"),init()),puts=[]})</script></body></html>